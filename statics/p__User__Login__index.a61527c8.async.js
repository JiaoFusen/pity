(self.webpackChunkpity=self.webpackChunkpity||[]).push([[9366],{5966:function(l,f,e){"use strict";var v=e(1413),o=e(45987),g=e(85893),a=e(92643),u=["fieldProps","proFieldProps"],p=["fieldProps","proFieldProps"],F="text",T=function(I){var s=I.fieldProps,m=I.proFieldProps,U=(0,o.Z)(I,u);return(0,g.jsx)(a.Z,(0,v.Z)({valueType:F,fieldProps:s,filedConfig:{valueType:F},proFieldProps:m},U))},E=function(I){var s=I.fieldProps,m=I.proFieldProps,U=(0,o.Z)(I,p);return(0,g.jsx)(a.Z,(0,v.Z)({valueType:"password",fieldProps:s,proFieldProps:m,filedConfig:{valueType:F}},U))},c=T;c.Password=E,c.displayName="ProFormComponent",f.Z=c},23273:function(l,f,e){"use strict";e.r(f),e.d(f,{default:function(){return Qe}});var v=e(15009),o=e.n(v),g=e(97857),a=e.n(g),u=e(99289),p=e.n(u),F=e(5574),T=e.n(F),E=e(99702),c=e(94171);function Q(r,i){return I.apply(this,arguments)}function I(){return I=p()(o()().mark(function r(i,n){return o()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.abrupt("return",(0,c.request)("/api/login/captcha",a()({method:"GET",params:a()({},i)},n||{})));case 1:case"end":return S.stop()}},r)})),I.apply(this,arguments)}var s=e(1413),m=e(67294),U={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0138.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"}}]},name:"github",theme:"outlined"},de=U,re=e(84089),ne=function(i,n){return m.createElement(re.Z,(0,s.Z)((0,s.Z)({},i),{},{ref:n,icon:de}))};ne.displayName="GithubOutlined";var fe=m.forwardRef(ne),ge=e(87547),ae=e(94149),pe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M744 62H280c-35.3 0-64 28.7-64 64v768c0 35.3 28.7 64 64 64h464c35.3 0 64-28.7 64-64V126c0-35.3-28.7-64-64-64zm-8 824H288V134h448v752zM472 784a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"mobile",theme:"outlined"},ve=pe,ie=function(i,n){return m.createElement(re.Z,(0,s.Z)((0,s.Z)({},i),{},{ref:n,icon:ve}))};ie.displayName="MobileOutlined";var me=m.forwardRef(ie),X=e(45987),t=e(85893),he=e(46803),xe=e(58720),Pe=e(94184),ye=e.n(Pe),Fe=e(97269),Y=e(4942),be=e(98082),je=function(i){var n;return n={},(0,Y.Z)(n,i.componentCls,{"&-container":{display:"flex",flex:"1",flexDirection:"column",height:"100%",paddingInline:32,paddingBlock:24,overflow:"auto",background:"inherit"},"&-top":{textAlign:"center"},"&-header":{display:"flex",alignItems:"center",justifyContent:"center",height:"44px",lineHeight:"44px",a:{textDecoration:"none"}},"&-title":{position:"relative",insetBlockStart:"2px",color:"@heading-color",fontWeight:"600",fontSize:"33px"},"&-logo":{width:"44px",height:"44px",marginInlineEnd:"16px",verticalAlign:"top",img:{width:"100%"}},"&-desc":{marginBlockStart:"12px",marginBlockEnd:"40px",color:i.colorTextSecondary,fontSize:i.fontSize},"&-main":{minWidth:"328px",maxWidth:"500px",margin:"0 auto","&-other":{marginBlockStart:"24px",lineHeight:"22px",textAlign:"start"}}}),(0,Y.Z)(n,"@media (min-width: @screen-md-min)",(0,Y.Z)({},"".concat(i.componentCls,"-container"),{paddingInline:0,paddingBlockStart:32,paddingBlockEnd:24,backgroundRepeat:"no-repeat",backgroundPosition:"center 110px",backgroundSize:"100%"})),n};function Ze(r){return(0,be.Xj)("LoginForm",function(i){var n=(0,s.Z)((0,s.Z)({},i),{},{componentCls:".".concat(r)});return[je(n)]})}var Me=["logo","message","contentStyle","title","subTitle","actions","children"];function Ce(r){var i,n=r.logo,x=r.message,S=r.contentStyle,D=r.title,w=r.subTitle,N=r.actions,W=r.children,b=(0,X.Z)(r,Me),R=(0,he.YB)(),B=b.submitter===!1?!1:(0,s.Z)((0,s.Z)({searchConfig:{submitText:R.getMessage("loginForm.submitText","\u767B\u5F55")}},b.submitter),{},{submitButtonProps:(0,s.Z)({size:"large",style:{width:"100%"}},(i=b.submitter)===null||i===void 0?void 0:i.submitButtonProps),render:function(Z,$){var K,V=$.pop();if(typeof(b==null||(K=b.submitter)===null||K===void 0?void 0:K.render)=="function"){var M,A;return b==null||(M=b.submitter)===null||M===void 0||(A=M.render)===null||A===void 0?void 0:A.call(M,Z,$)}return V}}),z=(0,m.useContext)(xe.ZP.ConfigContext),k=z.getPrefixCls("pro-form-login"),C=Ze(k),j=C.wrapSSR,P=C.hashId,d=function(Z){return"".concat(k,"-").concat(Z," ").concat(P)},y=(0,m.useMemo)(function(){return n?typeof n=="string"?(0,t.jsx)("img",{src:n}):n:null},[n]);return j((0,t.jsxs)("div",{className:ye()(d("container"),P),children:[(0,t.jsxs)("div",{className:"".concat(d("top")," ").concat(P),children:[D||y?(0,t.jsxs)("div",{className:"".concat(d("header")),children:[y?(0,t.jsx)("span",{className:d("logo"),children:y}):null,D?(0,t.jsx)("span",{className:d("title"),children:D}):null]}):null,w?(0,t.jsx)("div",{className:d("desc"),children:w}):null]}),(0,t.jsxs)("div",{className:d("main"),style:(0,s.Z)({width:328},S),children:[(0,t.jsxs)(Fe.A,(0,s.Z)((0,s.Z)({isKeyPressSubmit:!0},b),{},{submitter:B,children:[x,W]})),N?(0,t.jsx)("div",{className:d("main-other"),children:N}):null]})]}))}var J=e(5966),H=e(74165),se=e(15861),q=e(97685),Se=e(58131),Oe=e(96365),Te=e(71577),oe=e(90789),we=["rules","name","phoneName","fieldProps","captchaTextRender","captchaProps"],Be=m.forwardRef(function(r,i){var n=Se.Z.useFormInstance(),x=(0,m.useState)(r.countDown||60),S=(0,q.Z)(x,2),D=S[0],w=S[1],N=(0,m.useState)(!1),W=(0,q.Z)(N,2),b=W[0],R=W[1],B=(0,m.useState)(),z=(0,q.Z)(B,2),k=z[0],C=z[1],j=r.rules,P=r.name,d=r.phoneName,y=r.fieldProps,h=r.captchaTextRender,Z=h===void 0?function(M,A){return M?"".concat(A," \u79D2\u540E\u91CD\u65B0\u83B7\u53D6"):"\u83B7\u53D6\u9A8C\u8BC1\u7801"}:h,$=r.captchaProps,K=(0,X.Z)(r,we),V=function(){var M=(0,se.Z)((0,H.Z)().mark(function A(G){return(0,H.Z)().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.prev=0,C(!0),L.next=4,K.onGetCaptcha(G);case 4:C(!1),R(!0),L.next=13;break;case 8:L.prev=8,L.t0=L.catch(0),R(!1),C(!1),console.log(L.t0);case 13:case"end":return L.stop()}},A,null,[[0,8]])}));return function(G){return M.apply(this,arguments)}}();return(0,m.useImperativeHandle)(i,function(){return{startTiming:function(){return R(!0)},endTiming:function(){return R(!1)}}}),(0,m.useEffect)(function(){var M=0,A=r.countDown;return b&&(M=window.setInterval(function(){w(function(G){return G<=1?(R(!1),clearInterval(M),A||60):G-1})},1e3)),function(){return clearInterval(M)}},[b]),(0,t.jsxs)("div",{style:(0,s.Z)((0,s.Z)({},y==null?void 0:y.style),{},{display:"flex",alignItems:"center"}),ref:i,children:[(0,t.jsx)(Oe.Z,(0,s.Z)((0,s.Z)({},y),{},{style:{flex:1,transition:"width .3s",marginRight:8}})),(0,t.jsx)(Te.ZP,(0,s.Z)((0,s.Z)({style:{display:"block"},disabled:b,loading:k},$),{},{onClick:function(){var M=(0,se.Z)((0,H.Z)().mark(function G(){var te;return(0,H.Z)().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(O.prev=0,!d){O.next=9;break}return O.next=4,n.validateFields([d].flat(1));case 4:return te=n.getFieldValue([d].flat(1)),O.next=7,V(te);case 7:O.next=11;break;case 9:return O.next=11,V("");case 11:O.next=16;break;case 13:O.prev=13,O.t0=O.catch(0),console.log(O.t0);case 16:case"end":return O.stop()}},G,null,[[0,13]])}));function A(){return M.apply(this,arguments)}return A}(),children:Z(b,D)}))]})}),Ae=(0,oe.G)(Be),Ee=Ae,le=e(22270),Ie=e(32808),ue=e(92643),De=["options","fieldProps","proFieldProps","valueEnum"],Le=m.forwardRef(function(r,i){var n=r.options,x=r.fieldProps,S=r.proFieldProps,D=r.valueEnum,w=(0,X.Z)(r,De);return(0,t.jsx)(ue.Z,(0,s.Z)({ref:i,valueType:"checkbox",valueEnum:(0,le.h)(D,void 0),fieldProps:(0,s.Z)({options:n},x),lightProps:(0,s.Z)({labelFormatter:function(){return(0,t.jsx)(ue.Z,(0,s.Z)({ref:i,valueType:"checkbox",mode:"read",valueEnum:(0,le.h)(D,void 0),filedConfig:{customLightMode:!0},fieldProps:(0,s.Z)({options:n},x),proFieldProps:S},w))}},w.lightProps),proFieldProps:S},w))}),Re=m.forwardRef(function(r,i){var n=r.fieldProps,x=r.children;return(0,t.jsx)(Ie.Z,(0,s.Z)((0,s.Z)({ref:i},n),{},{children:x}))}),Ne=(0,oe.G)(Re,{valuePropName:"checked"}),ce=Ne;ce.Group=Le;var Ge=ce,_=e(19922),ee=e(2453),We=e(93980),ze=e(67610),ke=e(73935),Ue="0f4fc0a875de30614a6a",Ke=function(){window.location.href="https://github.com/login/oauth/authorize?client_id=".concat(Ue)},He=function(){var i=(0,_.l)(function(n){var x=n.token;return{marginLeft:"8px",color:"rgba(0, 0, 0, 0.2)",fontSize:"24px",verticalAlign:"middle",cursor:"pointer",transition:"color 0.3s","&:hover":{color:x.colorPrimaryActive}}});return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(fe,{className:i,onClick:Ke},"GithubOutlined")})},$e=function(){var i=(0,_.l)(function(n){var x=n.token;return{width:42,height:42,lineHeight:"42px",position:"fixed",right:16,borderRadius:x.borderRadius,":hover":{backgroundColor:x.colorBgTextHover}}});return(0,t.jsx)("div",{className:i,"data-lang":!0,children:c.SelectLang&&(0,t.jsx)(c.SelectLang,{})})},Ve=function(){var i=(0,m.useState)("account"),n=T()(i,2),x=n[0],S=n[1],D=(0,c.useModel)("@@initialState"),w=D.initialState,N=D.setInitialState,W=(0,c.useModel)("auth"),b=W.loginPity,R=(0,_.l)(function(){return{display:"flex",flexDirection:"column",height:"100vh",overflow:"auto",backgroundImage:"url('https://mdn.alipayobjects.com/yuyan_qk0oxh/afts/img/V-_oS6r-i7wAAAAAAAAAAAAAFl94AQBr')",backgroundSize:"100% 100%"}}),B=(0,c.useIntl)(),z=function(){var C=p()(o()().mark(function j(){var P,d;return o()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,w==null||(P=w.fetchUserInfo)===null||P===void 0?void 0:P.call(w);case 2:d=h.sent,d&&(0,ke.flushSync)(function(){N(function(Z){return a()(a()({},Z),{},{currentUser:d})})});case 4:case"end":return h.stop()}},j)}));return function(){return C.apply(this,arguments)}}(),k=function(){var C=p()(o()().mark(function j(P){var d,y;return o()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.next=2,b({username:P.username,password:P.password});case 2:if(d=Z.sent,d.code!==0){Z.next=10;break}return ee.ZP.success("\u{1F389} \u{1F389} \u{1F389} \u767B\u5F55\u6210\u529F"),Z.next=7,z();case 7:return y=new URL(window.location.href).searchParams,c.history.push(y.get("redirect")||"/"),Z.abrupt("return");case 10:ee.ZP.error(d.msg);case 11:case"end":return Z.stop()}},j)}));return function(P){return C.apply(this,arguments)}}();return(0,t.jsxs)("div",{className:R,children:[(0,t.jsx)(c.Helmet,{children:(0,t.jsx)("title",{children:ze.Z.title})}),(0,t.jsx)($e,{}),(0,t.jsx)("div",{style:{flex:"1",padding:"32px 0"},children:(0,t.jsxs)(Ce,{contentStyle:{minWidth:280,maxWidth:"75vw"},logo:(0,t.jsx)("img",{alt:"logo",src:"/logo.svg"}),title:"pity",subTitle:B.formatMessage({id:"pages.layouts.userLayout.title"}),initialValues:{autoLogin:!0},actions:[(0,t.jsx)(c.FormattedMessage,{id:"pages.login.loginWith",defaultMessage:"\u5176\u4ED6\u767B\u5F55\u65B9\u5F0F"},"loginWith"),(0,t.jsx)(He,{},"icons")],onFinish:function(){var C=p()(o()().mark(function j(P){return o()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,k(P);case 2:case"end":return y.stop()}},j)}));return function(j){return C.apply(this,arguments)}}(),children:[(0,t.jsx)(We.Z,{activeKey:x,onChange:S,centered:!0,items:[{key:"account",label:B.formatMessage({id:"pages.login.accountLogin.tab",defaultMessage:"\u8D26\u6237\u5BC6\u7801\u767B\u5F55"})},{key:"register",label:B.formatMessage({id:"pages.login.phoneLogin.tab",defaultMessage:"\u6CE8\u518C"})}]}),x==="account"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(J.Z,{name:"username",fieldProps:{size:"large",prefix:(0,t.jsx)(ge.Z,{})},placeholder:B.formatMessage({id:"pages.login.username.placeholder",defaultMessage:"\u7528\u6237\u540D: tester"}),rules:[{required:!0,message:(0,t.jsx)(c.FormattedMessage,{id:"pages.login.username.required",defaultMessage:"\u8BF7\u8F93\u5165\u7528\u6237\u540D!"})}]}),(0,t.jsx)(J.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,t.jsx)(ae.Z,{})},placeholder:B.formatMessage({id:"pages.login.password.placeholder",defaultMessage:"\u5BC6\u7801: tester"}),rules:[{required:!0,message:(0,t.jsx)(c.FormattedMessage,{id:"pages.login.password.required",defaultMessage:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"})}]})]}),x==="register"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(J.Z,{fieldProps:{size:"large",prefix:(0,t.jsx)(me,{})},name:"mobile",placeholder:B.formatMessage({id:"pages.login.phoneNumber.placeholder",defaultMessage:"\u624B\u673A\u53F7"}),rules:[{required:!0,message:(0,t.jsx)(c.FormattedMessage,{id:"pages.login.phoneNumber.required",defaultMessage:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\uFF01"})},{pattern:/^1\d{10}$/,message:(0,t.jsx)(c.FormattedMessage,{id:"pages.login.phoneNumber.invalid",defaultMessage:"\u624B\u673A\u53F7\u683C\u5F0F\u9519\u8BEF\uFF01"})}]}),(0,t.jsx)(Ee,{fieldProps:{size:"large",prefix:(0,t.jsx)(ae.Z,{})},captchaProps:{size:"large"},placeholder:B.formatMessage({id:"pages.login.captcha.placeholder",defaultMessage:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"}),captchaTextRender:function(j,P){return j?"".concat(P," ").concat(B.formatMessage({id:"pages.getCaptchaSecondText",defaultMessage:"\u83B7\u53D6\u9A8C\u8BC1\u7801"})):B.formatMessage({id:"pages.login.phoneLogin.getVerificationCode",defaultMessage:"\u83B7\u53D6\u9A8C\u8BC1\u7801"})},name:"captcha",rules:[{required:!0,message:(0,t.jsx)(c.FormattedMessage,{id:"pages.login.captcha.required",defaultMessage:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801\uFF01"})}],onGetCaptcha:function(){var C=p()(o()().mark(function j(P){var d;return o()().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,Q({phone:P});case 2:if(d=h.sent,d){h.next=5;break}return h.abrupt("return");case 5:ee.ZP.success("\u83B7\u53D6\u9A8C\u8BC1\u7801\u6210\u529F\uFF01\u9A8C\u8BC1\u7801\u4E3A\uFF1A1234");case 6:case"end":return h.stop()}},j)}));return function(j){return C.apply(this,arguments)}}()})]}),(0,t.jsxs)("div",{style:{marginBottom:24},children:[(0,t.jsx)(Ge,{noStyle:!0,name:"autoLogin",children:(0,t.jsx)(c.FormattedMessage,{id:"pages.login.rememberMe",defaultMessage:"\u81EA\u52A8\u767B\u5F55"})}),(0,t.jsx)("a",{style:{float:"right"},children:(0,t.jsx)(c.FormattedMessage,{id:"pages.login.forgotPassword",defaultMessage:"\u5FD8\u8BB0\u5BC6\u7801"})})]})]})}),(0,t.jsx)(E.Z,{})]})},Qe=Ve},15746:function(l,f,e){"use strict";var v=e(21584);f.Z=v.Z},71230:function(l,f,e){"use strict";var v=e(92820);f.Z=v.Z},45520:function(l,f){"use strict";Object.defineProperty(f,"__esModule",{value:!0}),f.call=a,f.default=void 0,f.note=o,f.noteOnce=p,f.resetWarned=g,f.warning=v,f.warningOnce=u;var e={};function v(T,E){}function o(T,E){}function g(){e={}}function a(T,E,c){!E&&!e[c]&&(T(!1,c),e[c]=!0)}function u(T,E){a(v,T,E)}function p(T,E){a(o,T,E)}var F=u;f.default=F},38416:function(l,f,e){var v=e(64062);function o(g,a,u){return a=v(a),a in g?Object.defineProperty(g,a,{value:u,enumerable:!0,configurable:!0,writable:!0}):g[a]=u,g}l.exports=o,l.exports.__esModule=!0,l.exports.default=l.exports},42122:function(l,f,e){var v=e(38416);function o(a,u){var p=Object.keys(a);if(Object.getOwnPropertySymbols){var F=Object.getOwnPropertySymbols(a);u&&(F=F.filter(function(T){return Object.getOwnPropertyDescriptor(a,T).enumerable})),p.push.apply(p,F)}return p}function g(a){for(var u=1;u<arguments.length;u++){var p=arguments[u]!=null?arguments[u]:{};u%2?o(Object(p),!0).forEach(function(F){v(a,F,p[F])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(p)):o(Object(p)).forEach(function(F){Object.defineProperty(a,F,Object.getOwnPropertyDescriptor(p,F))})}return a}l.exports=g,l.exports.__esModule=!0,l.exports.default=l.exports},95036:function(l,f,e){var v=e(18698).default;function o(g,a){if(v(g)!=="object"||g===null)return g;var u=g[Symbol.toPrimitive];if(u!==void 0){var p=u.call(g,a||"default");if(v(p)!=="object")return p;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(g)}l.exports=o,l.exports.__esModule=!0,l.exports.default=l.exports},64062:function(l,f,e){var v=e(18698).default,o=e(95036);function g(a){var u=o(a,"string");return v(u)==="symbol"?u:String(u)}l.exports=g,l.exports.__esModule=!0,l.exports.default=l.exports}}]);
